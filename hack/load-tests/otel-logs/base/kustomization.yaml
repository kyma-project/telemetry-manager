apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: log-load-test

resources:
  - log-receiver.yaml
  - log-gateway.yaml
  - log-generator.yaml

configMapGenerator:
  - name: log-gateway
    files:
      - relay.yaml=config/relay.yaml
  - name: log-receiver
    files:
      - config.yaml=config/receiver.yaml
  - name: environment-variables
    envs: [base.env]
    behavior: create

vars:
  - name: LOG_RATE
    objref:
      kind: ConfigMap
      name: environment-variables
      apiVersion: v1
    fieldref:
      fieldpath: data.LOG_RATE
  - name: LOG_CONTENT
    objref:
      kind: ConfigMap
      name: environment-variables
      apiVersion: v1
    fieldref:
      fieldpath: data.LOG_CONTENT
