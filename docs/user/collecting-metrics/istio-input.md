# Collect Istio Metrics

To monitor the health and performance of your service mesh, enable the `istio` input in your `MetricPipeline`. This collects metrics from the Istio proxies (sidecars) running alongside your applications. You can choose to collect Envoy metrics and diagnostic metrics, and you can control from which namespaces metrics are collected.

## Prerequisites

- The Istio module is added in your cluster. See [Quick Install](https://kyma-project.io/#/02-get-started/01-quick-install).
- You have access to Kyma dashboard. Alternatively, if you prefer CLI, you need [kubectl](https://kubernetes.io/docs/tasks/tools/#kubectl).

> **Note:** This configuration collects metrics generated by the Istio proxies themselves. To collect custom metrics exposed by your own applications running in the service mesh, you must configure your application accordingly. For details, see [Scrape Metrics from Istio-enabled Workloads](prometheus-input.md#scrape-metrics-from-istio-enabled-workloads).

## Activate Istio Metrics

By default, the `istio` input is disabled. If you are using Istio, enable the collection of Istio metrics:

```yaml
  ...
  input:
    istio:
      enabled: true
```

With this, the metric agent starts collecting all Istio metrics from Istio sidecars from all namespaces (including system namespaces).

> **Tip:** To validate or debug your configuration, use diagnostic metrics (see [Collect Diagnostic Metrics](#collect-diagnostic-metrics)).

## Collect Envoy Metrics

By default, the metric agent collects only `istio` metrics (prefixed with `istio_`) and ignores Envoy metrics (prefixed with `envoy_`).

Envoy metrics help you understand the performance and behavior of your Envoy proxy, providing details like request rates, latencies, and error counts. For details, see [Envoy metrics](https://www.envoyproxy.io/docs/envoy/latest/configuration/upstream/cluster_manager/cluster_stats) and [server metrics](https://www.envoyproxy.io/docs/envoy/latest/configuration/observability/statistics).

To use Envoy metrics to observe and troubleshoot service mesh traffic, enable the `envoyMetrics` section under the `istio` input:

## Collect Diagnostic Metrics
<!-- identical section for Prometheus and Istio docs -->
To validate or debug your scraping configuration for the `prometheus` and `istio` input, you can use diagnostic metrics. By default, they are disabled.

> **Note:** Unlike the `prometheus` and `istio` inputs, the `runtime`  input gathers data directly from Kubernetes APIs instead of using a scraping process, so it does not generate scrape-specific diagnostic metrics.

To use diagnostic metrics, enable the `diagnosticMetrics` for the input in your MetricPipeline:

```yaml
  ...
  input:
    istio:
    enabled: true
    diagnosticMetrics:
        enabled: true
```

When enabled, the metric agent generates metrics about its own scrape jobs, such as the following:

- `scrape_duration_seconds`
- `scrape_samples_scraped`
- `scrape_samples_post_metric_relabeling`
- `scrape_series_added`
